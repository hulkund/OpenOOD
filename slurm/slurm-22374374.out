#!/bin/bash
got config
got data
Model Loading resnet18_32x32 Completed!
got network
got evaluator, postprocessor
/state/partition1/llgrid/pkg/anaconda/anaconda3-2022a/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/gridsan/nhulkund/.local/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:32: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
acc metric
Performing inference on cifar10 dataset...
Processing nearood...
Performing inference on cifar100 dataset...
Computing metrics on cifar100 dataset...
FPR@95: 23.33, AUROC: 96.18 AUPR_IN: 96.80, AUPR_OUT: 95.10
CCR: 5.91, 16.57, 71.29, 90.23, ACC: 95.24
──────────────────────────────────────────────────────────────────────
Performing inference on tin dataset...
Computing metrics on tin dataset...
FPR@95: 20.30, AUROC: 96.62 AUPR_IN: 97.34, AUPR_OUT: 95.52
CCR: 12.99, 40.39, 78.22, 90.84, ACC: 95.24
──────────────────────────────────────────────────────────────────────
Computing mean metrics...
FPR@95: 21.82, AUROC: 96.40 AUPR_IN: 97.07, AUPR_OUT: 95.31
CCR: 9.45, 28.48, 74.76, 90.54, ACC: 95.24
──────────────────────────────────────────────────────────────────────
Processing farood...
Performing inference on mnist dataset...
Computing metrics on mnist dataset...
FPR@95: 8.81, AUROC: 97.86 AUPR_IN: 94.99, AUPR_OUT: 99.61
CCR: 43.10, 76.64, 88.81, 92.51, ACC: 95.24
──────────────────────────────────────────────────────────────────────
Performing inference on svhn dataset...
Computing metrics on svhn dataset...
FPR@95: 5.43, AUROC: 98.44 AUPR_IN: 97.59, AUPR_OUT: 99.28
CCR: 69.36, 82.87, 89.74, 92.99, ACC: 95.24
──────────────────────────────────────────────────────────────────────
Performing inference on texture dataset...
Computing metrics on texture dataset...
FPR@95: 23.48, AUROC: 96.08 AUPR_IN: 97.78, AUPR_OUT: 92.13
CCR: 2.84, 24.24, 71.96, 90.22, ACC: 95.24
──────────────────────────────────────────────────────────────────────
Performing inference on place365 dataset...
Computing metrics on place365 dataset...
FPR@95: 22.76, AUROC: 96.32 AUPR_IN: 92.18, AUPR_OUT: 98.72
CCR: 8.08, 33.94, 74.43, 90.10, ACC: 95.24
──────────────────────────────────────────────────────────────────────
Computing mean metrics...
FPR@95: 15.12, AUROC: 97.17 AUPR_IN: 95.64, AUPR_OUT: 97.43
CCR: 30.84, 54.43, 81.24, 91.46, ACC: 95.24
──────────────────────────────────────────────────────────────────────
ood metric
ran metrics
cifar10 msp base rand_n= 2  rand_m= 9
Traceback (most recent call last):
  File "get_ood_metrics.py", line 87, in <module>
    ood_df.to_csv(PATH+filename)
  File "/home/gridsan/nhulkund/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 3563, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/home/gridsan/nhulkund/.local/lib/python3.8/site-packages/pandas/io/formats/format.py", line 1180, in to_csv
    csv_formatter.save()
  File "/home/gridsan/nhulkund/.local/lib/python3.8/site-packages/pandas/io/formats/csvs.py", line 241, in save
    with get_handle(
  File "/home/gridsan/nhulkund/.local/lib/python3.8/site-packages/pandas/io/common.py", line 697, in get_handle
    check_parent_directory(str(handle))
  File "/home/gridsan/nhulkund/.local/lib/python3.8/site-packages/pandas/io/common.py", line 571, in check_parent_directory
    raise OSError(fr"Cannot save file into a non-existent directory: '{parent}'")
OSError: Cannot save file into a non-existent directory: '/home/gridsan/nhulkund/OpenOOD/home/gridsan/nhulkund/OpenOOD/results/hparam/image_size: 32
interpolation: bilinear
name: cifar10
normalization_type: cifar10
num_classes: 10
num_gpus: 1
num_machines: 1
num_workers: 8
pre_size: 32
split_names: ['train', 'val', 'test']
test:
    batch_size: 200
    data_dir: ./data/images_classic/
    dataset_class: ImglistDataset
    imglist_pth: ./data/benchmark_imglist/cifar10/test_cifar10.txt
    shuffle: False
train:
    batch_size: 128
    data_dir: ./data/images_classic/
    dataset_class: ImglistDataset
    imglist_pth: ./data/benchmark_imglist/cifar10/train_cifar10.txt
    shuffle: True
val:
    batch_size: 200
    data_dir: ./data/images_classic/
    dataset_class: ImglistDataset
    imglist_pth: ./data/benchmark_imglist/cifar10'
